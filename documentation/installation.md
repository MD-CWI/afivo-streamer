# Installation

# Requirements

* A UNIX-like operating system such as GNU/Linux
* A recent Fortran compiler such as gfortran 4.8 or newer
* A recent C compiler such as gcc to compile the [Silo](https://wci.llnl.gov/simulation/computer-codes/silo) library
* `git` to download and update the source code

# Installation

Run the following command in a folder to clone the repository:

    git clone https://gitlab.com/MD-CWI-NL/afivo-streamer.git

Then you can go into the folder and compile the code:

    cd afivo-streamer
    make

Afterwards, you can run some of the example, see @ref md_documentation_examples.

# Updating to the latest version

If you want to update your previously downloaded code, go into your afivo-streamer folder and pull the new version:

    git pull

Afterwards, you can recompile the code by typing

    make

either in the `afivo-streamer` folder, or in a specific program folder with a `Makefile`.

# List of issues and solutions

## Problems compiling Silo

* The script `build_silo.sh` can be executed manually from the `afivo/external_libraries' folder for easier debugging. 
* Make sure the default C, C++ and Fortran compiler are configured correctly. For example, use `export FC=/usr/bin/gfortran' in your shell to specify the Fortran compiler.
* `/usr/bin/ld: cannot find -lsz`. **Solution** (on Fedora) `sudo dnf install libaec-devel`

### The above solution gives a new error (encountered by some users using Fedora 30)

* Add the following lines to `build_silo.sh` just before the `#Configure` comment:
    `export CC=/usr/bin/gcc`
    `export CXX=/usr/bin/g++`
    `export FC=/usr/bin/gfortran`
    
### Making videos using VisIt
* The following link gives an overview on creating movies in VisIt: [Making movies in VisIt](https://www.visitusers.org/index.php?title=Making_Movies).

#### Issues encountered and the solutions:

* **Waiting message:** While making the videos using the default options, users may encounter a window saying 'VisIt is waiting for a CLI to launch on localhost'. This is due to the missing **xterm** package on the system. It can be installed using `sudo dnf install xterm`(Fedora) or `sudo apt-get install xterm` (Ubuntu).

* **Weird video generated:** The videos generated sometimes have a different color scheme or maybe the frames are inverted/mirrored. This was solved by installing the **ffmpeg** package using `sudo dnf install ffmpeg`(Fedora) or `sudo apt-get install ffmpeg` (Ubuntu).` 

* **Bad video quality/Custom videos:** The videos generated by VisIt maybe of bad quality or the user may want to make videos of a particular portion of the simulation domain. Then a set of PNG/JPEG images can be generated using VisIt, which can be suitably modified and made into a video using **ffmpeg** as follows:
  
    Suppose the set of PNG files are _movie0000.png_ ... _movie0032.png_ and the output video name is _resultVideo.mp4_, then the necessary command is

    ffmpeg -i movie%04d.png resultVideo.mp4
